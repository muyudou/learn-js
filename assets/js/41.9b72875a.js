(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{446:function(t,s,a){"use strict";a.r(s);var e=a(2),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[t._v("我们始终被外在的东西所折磨，但只要活在当下，专注此时此刻做的每一件事情，把它做到极致，则就是那滴蜜糖。抓住这一点，我们就不再焦虑。")])]),t._v(" "),s("h1",{attrs:{id:"背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),s("p",[t._v("本文内容来自于小册"),s("a",{attrs:{href:"https://juejin.cn/book/7115598540721618944/",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack5核心原理与应用实现"),s("OutboundLink")],1),t._v(", 总结一下对自己有帮助的点，这本小册总体写的不错，比较大的收获有：")]),t._v(" "),s("ol",[s("li",[t._v("对webpack的配置文件的理解")]),t._v(" "),s("li",[t._v("js、css、图片 常用loader配置以及比较")]),t._v(" "),s("li",[t._v("webpack优化方案")]),t._v(" "),s("li",[t._v("webpack原理（后续单独总结）")])]),t._v(" "),s("p",[t._v("写文章不易，写了几天，辛苦大家多多支持和指正~")]),t._v(" "),s("h1",{attrs:{id:"一、重新理解webpack配置项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、重新理解webpack配置项"}},[t._v("#")]),t._v(" 一、重新理解webpack配置项")]),t._v(" "),s("p",[t._v("由于webpack的配置项众多，之前在脑海里都是一个一个的点，根本没有串起来，而且也记不住，但是换一种理解方法的话，就容易理解了。如果我们按照webpack的构建流程可以将配置项划分为两类来理解：")]),t._v(" "),s("ol",[s("li",[t._v("流程类：主要是干预打包编译规则，直接影响打包结果。")]),t._v(" "),s("li",[t._v("工具类：打包流程外，提供工程化的配置项。")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b211c7ce4514c0e80f5895eecc27d63~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2190&h=807&s=316838&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h3",{attrs:{id:"_1-流程类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-流程类"}},[t._v("#")]),t._v(" 1. 流程类")]),t._v(" "),s("p",[t._v("根据webpack编译流程来看构建项，这样的话就明白为什么会有这个配置项了。所以先来回顾下webpack的构建流程：")]),t._v(" "),s("p",[s("strong",[t._v("webpack编译流程")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("输入")]),t._v("：webpack从文件系统的读取入口")]),t._v(" "),s("li",[s("strong",[t._v("模块递归处理")]),t._v("：读取分析entry模块，调用Loader转译Module内容，并转换为AST，找到模块依赖，递归处理依赖，直到所有模块都处理完毕。")]),t._v(" "),s("li",[s("strong",[t._v("后处理")]),t._v("：所有模块处理完成后，根据Entry配置将模块封装进不同的Chunk对象，经过模块合并、注入运行时、产物优化，将模块按照chunk合并成最终产物，写入文件系统。")])]),t._v(" "),s("p",[t._v("按照以上流程划分配置项有：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95212fd4440b4111bdb1e1601ab3c8c2~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1574&h=754&s=181241&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("p",[t._v("总结起来：")]),t._v(" "),s("ol",[s("li",[t._v("webpack首先根据输入配置entry找到项目入口文件")]),t._v(" "),s("li",[t._v("按照模块配置相关的内容（"),s("code",[t._v("module/resolve/externals")]),t._v("）配置的规则处理模块，包括对各种类型文件利用loader转换为js类型、依赖分析等。")]),t._v(" "),s("li",[t._v("最后根据后处理相关的配置（"),s("code",[t._v("optimization/target")]),t._v("）合并模块资源、注入运行时依赖、优化产物等。")])]),t._v(" "),s("p",[t._v("比较重要的点：")]),t._v(" "),s("ol",[s("li",[t._v("resolve：告诉webpack怎么去找模块，这一步是webpack常用的优化点（考点），\n"),s("ul",[s("li",[t._v("可以通过设置resolve的"),s("code",[t._v("extensions")]),t._v("缩小文件后缀的遍历路径，")]),t._v(" "),s("li",[t._v("或者resolve的"),s("code",[t._v("modules")]),t._v("设置import的路径，一般设置为当前目录下的node_modules")])])]),t._v(" "),s("li",[t._v("module：可以理解为loader配置，js、css、img等的loader配置")]),t._v(" "),s("li",[t._v("optimization：splitChunk的分包配置等在这里，属于chunk生成阶段使用的。")])]),t._v(" "),s("h3",{attrs:{id:"_2-工具类配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-工具类配置"}},[t._v("#")]),t._v(" 2. 工具类配置")]),t._v(" "),s("p",[t._v("用于解决某一工程类问题，可以划分为以下三类：")]),t._v(" "),s("ol",[s("li",[t._v("开发效率类：watch、devtool、devServer")]),t._v(" "),s("li",[t._v("性能优化类：cache、performance")]),t._v(" "),s("li",[t._v("日志类：stats、infrastructureLogging")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0411b15f94c496faec6d119c17cae9b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1522&h=646&s=173244&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h1",{attrs:{id:"二、-js、css、img常用loader梳理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、-js、css、img常用loader梳理"}},[t._v("#")]),t._v(" 二、 js、css、img常用loader梳理")]),t._v(" "),s("p",[t._v("这块的话js比较熟悉，css插件不少，有时候记不住，需要梳理下，还有img的，也容易迷糊😓。")]),t._v(" "),s("blockquote",[s("p",[t._v("注意：loader执行顺序从右到左。")])]),t._v(" "),s("h3",{attrs:{id:"_1-js-loader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-js-loader"}},[t._v("#")]),t._v(" 1. js loader")]),t._v(" "),s("p",[t._v("js的loader最常用就是babel-loader，ts的话是ts-loader或者，还有一般会加eslint插件，eslint插件一般会加扩展包。不多说了，直接脑图总结：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e0a19a34ca144b8875dccf247d6d8ac~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1088&h=786&s=178755&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("p",[t._v("配置示例")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ESLintPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eslint-webpack-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/index.ts'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mode")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'development'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("devtool")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.ts$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-typescript'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ESLintPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("extensions")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.ts'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"_2-css"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-css"}},[t._v("#")]),t._v(" 2. css")]),t._v(" "),s("p",[t._v("webpack不能处理css，所以需要借助css-loader插件将它转换为js格式使它可以处理。然后再通过style-loader或者mini-css-extract-plugin插入到页面中。")]),t._v(" "),s("ul",[s("li",[t._v('css-loader：将css翻译为module.exports = "${css}"的js代码')]),t._v(" "),s("li",[t._v("插入页面，以下二选一：\n"),s("ul",[s("li",[t._v("style-loader创建一个style标签插入")]),t._v(" "),s("li",[t._v("mini-css-extract-plugin抽离成单独的css文件，通过link标签的方式插入到页面中")])])])]),t._v(" "),s("p",[t._v("除去以上基础的，还有css预处理器以及post-css：")]),t._v(" "),s("ul",[s("li",[t._v("less-loader、sass-loader，预处理器定义了一套css之上的超集，如Ts与js的关系。")]),t._v(" "),s("li",[t._v("post-css：增强原生css的能力，没有定义一门新的语言，而是将css解析为ast结构，并传入postcss插件做处理，具体功能都由插件实现，就像babel和js。")])]),t._v(" "),s("p",[t._v("脑图总结：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a17aa47353e42998c716780d8506fa5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1592&h=848&s=238788&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("p",[t._v("这里要注意的就是loader的顺序，实际处理顺序是从右到左，所以css的执行的流程:")]),t._v(" "),s("blockquote",[s("p",[t._v("less-loader=> post-css=> css-loader => style-loader，")])]),t._v(" "),s("p",[t._v("style-loader一定要在最后面css-loader后面，因为被解析为js后才能插入页面。")]),t._v(" "),s("p",[t._v("示例demo如下：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.css$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"style-loader"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"css-loader"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("            \n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("importLoaders")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcss-loader"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("postcssOptions")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加 autoprefixer 插件")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"autoprefixer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"less-loader"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"_3-图片处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-图片处理"}},[t._v("#")]),t._v(" 3. 图片处理")]),t._v(" "),s("p",[t._v("这一块webpack4和5有区别了，因为相关的loader，webpack5基本内置了处理流程，等同于将img、文本等也升级为webpack的一等公民了。")]),t._v(" "),s("p",[t._v("图片分两部分，一部分是加载图片时使用的loader，一个是图片相关优化的loader。")]),t._v(" "),s("h5",{attrs:{id:"图片加载相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片加载相关"}},[t._v("#")]),t._v(" 图片加载相关")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("loader")]),t._v(" "),s("th",[t._v("作用")]),t._v(" "),s("th",[t._v("webpack5")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("file-loader")]),t._v(" "),s("td",[t._v("图片引用转换为url并生成相应图片")]),t._v(" "),s("td",[s("code",[t._v('type = "asset/resource"\'')])])]),t._v(" "),s("tr",[s("td",[t._v("url-loader")]),t._v(" "),s("td",[t._v("对于小于阈值 "),s("code",[t._v("limit")]),t._v(" 的图像直接转化为 base64 编码，大于阈值用file-loader转换，看起来是file-loader升级版")]),t._v(" "),s("td",[s("code",[t._v('type = "asset/inline"')])])]),t._v(" "),s("tr",[s("td",[t._v("raw-loader")]),t._v(" "),s("td",[t._v("不做任何转移，只是简单将文件内容复制到产物中，适用于svg")]),t._v(" "),s("td",[s("code",[t._v('type = "asset/source"')])])])])]),t._v(" "),s("p",[t._v("以上loader不仅可以处理图片，还可以加载任意类型的多媒体和文本文件。")]),t._v(" "),s("h5",{attrs:{id:"图片优化相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片优化相关"}},[t._v("#")]),t._v(" 图片优化相关")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("优化方法")]),t._v(" "),s("th",[t._v("loader")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("图像压缩")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftcoopman%2Fimage-webpack-loader",title:"https://github.com/tcoopman/image-webpack-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("image-webpack-loader"),s("OutboundLink")],1),t._v(" 组件")]),t._v(" "),s("td",[t._v("底层依赖于 "),s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fimagemin%2Fimagemin",title:"https://github.com/imagemin/imagemin",target:"_blank",rel:"noopener noreferrer"}},[t._v("imagemin"),s("OutboundLink")],1),t._v(" 及一系列的图像优化工具")])]),t._v(" "),s("tr",[s("td",[t._v("响应式图片")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fresponsive-loader",title:"https://www.npmjs.com/package/responsive-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("responsive-loader"),s("OutboundLink")],1),t._v(" 等")]),t._v(" "),s("td",[t._v("生成不同尺寸的图片")])]),t._v(" "),s("tr",[s("td",[t._v("雪碧图")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fwebpack-spritesmith",title:"https://www.npmjs.com/package/webpack-spritesmith",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-spritesmith"),s("OutboundLink")],1),t._v(" 插件")]),t._v(" "),s("td",[t._v("目前使用场景减少，iconfont和base64图片处理了小图标相关的功能")])])])]),t._v(" "),s("p",[s("strong",[t._v("脑图总结")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3a80db6d9ff44db58763011efe5ef882~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1382&h=854&s=230452&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("p",[s("strong",[t._v("示例代码")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.jsx?$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("node_modules")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-env'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.less$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("i")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MiniCssExtractPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'css-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'less-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.svg$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("i")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'svg-url-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.(png|jpg)$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"asset/resource"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'image-webpack-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("disable")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mozjpeg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("quality")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h1",{attrs:{id:"三、webpack优化方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、webpack优化方案"}},[t._v("#")]),t._v(" 三、webpack优化方案")]),t._v(" "),s("p",[t._v("我们通常遇到性能分析问题，都要按照以下三个步骤来走：")]),t._v(" "),s("ol",[s("li",[t._v("度量")]),t._v(" "),s("li",[t._v("分析卡点")]),t._v(" "),s("li",[t._v("解决问题")])]),t._v(" "),s("h3",{attrs:{id:"性能度量工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能度量工具"}},[t._v("#")]),t._v(" 性能度量工具")]),t._v(" "),s("p",[t._v("那有哪些性能度量工具呢？")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b53b33b7f43b4f57a871886d4e534371~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1498&h=896&s=272534&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("p",[t._v("以上这些工具可以用于webpack打包结果分析。")]),t._v(" "),s("h3",{attrs:{id:"为什么会慢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么会慢"}},[t._v("#")]),t._v(" 为什么会慢")]),t._v(" "),s("p",[t._v("为什么webpack在大型项目中性能不佳？")]),t._v(" "),s("ul",[s("li",[t._v("一方面是js的单线程架构，无法并行执行，不像rust、go是支持多线程的，这也就是esbuild为啥优于webpack，因为语言层面就区别挺大。")]),t._v(" "),s("li",[t._v("另一方面从webpack的流程看，它要完成大量的文件读写、代码转译等操作。")])]),t._v(" "),s("h3",{attrs:{id:"性能优化方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能优化方法"}},[t._v("#")]),t._v(" 性能优化方法")]),t._v(" "),s("p",[t._v("关于性能优化，有没有觉得如果不实际操作，直接看那些优化方法，在面试的时候总是容易忘?为了让自己梳理清楚，可以将webpack的常用优化方法分为两个方向：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("方面")]),t._v(" "),s("th",[t._v("目的")]),t._v(" "),s("th",[t._v("方法")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("优化构建速度")]),t._v(" "),s("td",[t._v("提升开发效率")]),t._v(" "),s("td",[t._v("1. 持久化缓存"),s("br"),t._v(" 2. 并行构建"),s("br"),t._v(" 3. 缩小编译范围"),s("br"),t._v(" 4. 使用最新版本的webpack5、node")])]),t._v(" "),s("tr",[s("td",[t._v("优化运行时性能")]),t._v(" "),s("td",[t._v("提升网页运行时性能")]),t._v(" "),s("td",[t._v("1. 动态加载，减少首屏资源加载量"),s("br"),t._v(" 2. 代码压缩"),s("br"),t._v(" 3.tree-shaking、scope hoisting减少应用体积")])])])]),t._v(" "),s("h4",{attrs:{id:"一、构建速度优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、构建速度优化"}},[t._v("#")]),t._v(" 一、构建速度优化")]),t._v(" "),s("h5",{attrs:{id:"_1-持久化缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-持久化缓存"}},[t._v("#")]),t._v(" 1. 持久化缓存")]),t._v(" "),s("p",[t._v("这个就是空间换时间的思路了。因为webpack5自带了"),s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fconfiguration%2Fcache%2F%23cache",title:"https://webpack.js.org/configuration/cache/#cache",target:"_blank",rel:"noopener noreferrer"}},[t._v("持久化缓存"),s("OutboundLink")],1),t._v("的功能，所以可以从webpack5和4区分来看。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("webpack5的持久化缓存能够把首次构建结果保存到文件系统，下次构建就可以跳过解析、连接、编译，直接用上次编译好的对象。")])]),t._v(" "),s("li",[s("p",[t._v("webpack4可以借助插件实现类似的功能。例如"),s("a",{attrs:{href:"https://www.npmjs.com/package/cache-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("cache-loader"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://github.com/mzgoddard/hard-source-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("hard-source-webpack-plugin"),s("OutboundLink")],1),t._v("，这一点可以通过对vue-cli的内置的配置看出来，执行命令"),s("code",[t._v("vue inspect > output.js")]),t._v("或者"),s("code",[t._v("npx vue-cli-service inspect > output.js")]),t._v("来导出cli的默认配置，可以发现里面出现了2次cache-loader的影子。分别是在"),s("code",[t._v("vue-loader")]),t._v("和"),s("code",[t._v("babel-loader")]),t._v("前面，看吧，原来我们一直在使用cache-loader。")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/07cc8577986b40e584cdaeb91b1f0c39~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1702&h=936&s=175030&e=png&b=202020",alt:"image.png"}}),t._v(" "),s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4a99eb569f04be2a320cfb441120b3e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1608&h=628&s=235959&e=png&b=202020",alt:"image.png"}})]),t._v(" "),s("p",[t._v("脑图总结：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81094743a8ac4536837b6a9e3952e545~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1050&h=870&s=225146&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h5",{attrs:{id:"_2-并行构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-并行构建"}},[t._v("#")]),t._v(" 2. 并行构建")]),t._v(" "),s("p",[t._v("这一条是从单线程限制的方面优化，也是借助插件来实现。例如：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Famireh%2Fhappypack",title:"https://github.com/amireh/happypack",target:"_blank",rel:"noopener noreferrer"}},[t._v("HappyPack"),s("OutboundLink")],1),t._v("：多进程方式运行资源加载(Loader)逻辑，webpack4可以使用；")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Floaders%2Fthread-loader%2F",title:"https://webpack.js.org/loaders/thread-loader/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Thread-loader"),s("OutboundLink")],1),t._v("：Webpack 官方出品，同样以多进程方式运行资源加载逻辑，推荐webpack5使用；")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fparallel-webpack",title:"https://www.npmjs.com/package/parallel-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("Parallel-Webpack"),s("OutboundLink")],1),t._v("：多进程方式运行多个 Webpack 构建实例；")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fterser-webpack-plugin%23terseroptions",title:"https://www.npmjs.com/package/terser-webpack-plugin#terseroptions",target:"_blank",rel:"noopener noreferrer"}},[t._v("TerserWebpackPlugin"),s("OutboundLink")],1),t._v("：支持多进程方式执行代码压缩、uglify 功能。")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9deb6c10979744739c48f7cc46631a36~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=764&h=418&s=97049&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h5",{attrs:{id:"_3-缩小编译范围"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-缩小编译范围"}},[t._v("#")]),t._v(" 3. 缩小编译范围")]),t._v(" "),s("ul",[s("li",[t._v("优化loader的执行范围")]),t._v(" "),s("li",[t._v("模块解析，配置 "),s("code",[t._v("resolve")]),t._v(" 控制资源搜索范围；")]),t._v(" "),s("li",[t._v("针对 npm 包设置 "),s("code",[t._v("module.noParse")]),t._v(" 跳过编译步骤；")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6419e60e34384e48b6d8ac7161473e19~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=864&h=488&s=95107&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h5",{attrs:{id:"_4-使用最新版本的webpack5、node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用最新版本的webpack5、node"}},[t._v("#")]),t._v(" 4. 使用最新版本的webpack5、node")]),t._v(" "),s("h4",{attrs:{id:"二、运行时性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、运行时性能优化"}},[t._v("#")]),t._v(" 二、运行时性能优化")]),t._v(" "),s("h5",{attrs:{id:"_1-动态加载-减少首屏资源加载量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-动态加载-减少首屏资源加载量"}},[t._v("#")]),t._v(" 1. 动态加载，减少首屏资源加载量")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fplugins%2Fsplit-chunks-plugin%2F",title:"https://webpack.docschina.org/plugins/split-chunks-plugin/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SplitChunksPlugin"),s("OutboundLink")],1),t._v(" 是 Webpack 4 之后内置实现的最新分包方案。常用分包方案")]),t._v(" "),s("ul",[s("li",[t._v("node_modules设置分组")]),t._v(" "),s("li",[t._v("业务代码\n"),s("ul",[s("li",[t._v("运行时代码单独抽离chunk")]),t._v(" "),s("li",[t._v("设置common分组，通过minChunk设置使用多次的抽离为chunk")])])])]),t._v(" "),s("h5",{attrs:{id:"_2-代码压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-代码压缩"}},[t._v("#")]),t._v(" 2. 代码压缩")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("terser-webpack-plugin")]),t._v("：用于压缩 JS 代码的插件；")]),t._v(" "),s("li",[s("code",[t._v("css-minimizer-webpack-plugin")]),t._v("：用于压缩 CSS 代码的插件；")]),t._v(" "),s("li",[s("code",[t._v("html-minifier-terser")]),t._v("：用于压缩 HTML 代码的插件。")])]),t._v(" "),s("p",[t._v("插件都支持 "),s("code",[t._v("include/test/exclude")]),t._v(" 配置项，用于控制压缩功能的应用范围；也都支持 "),s("code",[t._v("minify")]),t._v(" 配置项，用于切换压缩器，借助这个配置我们可以使用性能更佳的工具，如 ESBuild 执行压缩。")]),t._v(" "),s("h5",{attrs:{id:"_3-利用tree-shaking、scope-hoisting减少应用体积"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-利用tree-shaking、scope-hoisting减少应用体积"}},[t._v("#")]),t._v(" 3. 利用tree-shaking、scope hoisting减少应用体积")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72cb0680e9a447ac8f6e887cfd0e769a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1370&h=1190&s=262271&e=png&b=ffffff",alt:"image.png"}})]),t._v(" "),s("h1",{attrs:{id:"四、webpack5新特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、webpack5新特性"}},[t._v("#")]),t._v(" 四、webpack5新特性")]),t._v(" "),s("p",[t._v("既然是webpack5，就把webpack5的升级点简单总结下吧。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc4b2fc90fde43e397f523babea8039f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1502&h=808&s=214510&e=png&b=ffffff",alt:"image.png"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);